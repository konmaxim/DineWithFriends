@page
@model IndexModel
@{
    ViewData["Title"] = "Index";
}
@{
    Layout = "_ManageLayout";
}
<style>
    .fade-out {
        opacity: 1;
        transition: opacity 2s ease-out;
    }

        .fade-out.hide {
            opacity: 0;
        }
</style>
<h1>Account Settings</h1>
<div class="tabs" role="tablist">
    <button class="active" data-target="#profile">Profile</button>

</div>
<section id="profile" class="card">
    <h2>Profile Information</h2>
    <div class="row align-items-start">
        <div class="col-md-8">
            <form method="post" enctype="multipart/form-data">
                <div class="form-group">
                    <label> Nickname</label>
                    <input asp-for="Input.NickName" class="form-control" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.PhoneNumber"></label>
                    <input asp-for="Input.PhoneNumber" class="form-control" />
                </div>
                <div class="form-group">
                    <label asp-for="Input.BirthDay"></label>
                    <input asp-for="Input.BirthDay" class="form-control" type="date" />
                </div>
                <button type="submit" class="btn btn-primary">Update Profile</button>
            </form>

            @if (!string.IsNullOrEmpty(Model.StatusMessage))
            {
                <div id="statusMessage" class="alert alert-success fade-out mt-3">
                    @Model.StatusMessage
                </div>
            }
        </div>

        <div class="col-md-4 text-center mt-3 mt-md-0">
            <form asp-page-handler="ProfilePictureEdit"
                  method="post"
                  enctype="multipart/form-data">

               
                <img src="@Model.pfpPathDisplay"
                     class="rounded-circle"
                     width="140"
                     height="140"
                     id="profileImage"
                     style="cursor:pointer;" />

               
                <input asp-for="ProfilePicture"
                       type="file"
                       accept="image/*"
                       class="d-none"
                       id="filePicker" />

                <button type="submit"
                        class="btn btn-primary mt-2 d-none"
                        id="submitBtn">
                    Submit
                </button>
            </form>
        </div>
    </div>
</section>

    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        const msg = document.getElementById('statusMessage');
        if (msg) {
            setTimeout(() => {
                msg.classList.add('hide');
            }, 3000); // wait 3 seconds before starting fade out
        }
    });
</script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const img = document.getElementById("profileImage");
        const fileInput = document.getElementById("filePicker");
        const submitBtn = document.getElementById("submitBtn");

        // 1️⃣ click the picture ➜ open file dialog
        img.addEventListener("click", () => fileInput.click());

        // 2️⃣ after a file is chosen ➜ update preview & show button
        fileInput.addEventListener("change", ev => {
            const file = ev.target.files[0];
            if (!file) return;

            // live preview
            const url = URL.createObjectURL(file);
            img.src = url;

            // reveal the submit button
            submitBtn.classList.remove("d-none");
        });
    });
</script>